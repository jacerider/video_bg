!function(e,i,t,o){"use strict";function s(i,t){this.window=e(window),this.document=e(document),this.wrapper=i,this.settings=e.extend(!0,{},this._defaults,t),this.initialize()}e.extend(s,{debug:!1,instances:[],youtube_api_state:0,get_youtube_api:function(i){var t=this;if(0===t.youtube_api_state){this.log("YouTube API Fetch"),t.youtube_api_state=1;var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(o,s),window.onYouTubeIframeAPIReady=e.proxy(function(){this.log("YouTube API Ready"),t.youtube_api_state=2,i.build_youtube(),e(document).trigger("video-bg-youtube-ready")},this)}else 1===t.youtube_api_state?e(document).on("video-bg-youtube-ready",function(){i.build_youtube()}):2===t.youtube_api_state&&i.build_youtube()},log:function(e,i){var t=this;i=i||"",t.debug&&("object"==typeof e?console.log("[VideoBg]"+i,e):console.log("[VideoBg]"+i+" "+e))},error:function(e,i){i=i||"","object"==typeof e?console.error("[VideoBg]"+i,e):console.error("[VideoBg]"+i+" "+e)}}),e.extend(s.prototype,{_defaults:{position:"absolute",zIndex:"-1",video_ratio:!1,loop:!0,autoplay:!0,mute:!1,mp4:!1,webm:!1,ogg:!1,youtube:!1,priority:"html5",image:!1,sizing:"fil",start:0},initialize:function(){var e=this;e.set_wrapper_id(),e.set_inner_wrapper(),e.set_mobile_support(),e.set_video_support(),e.set_decision(),e["make_"+e.decision]()},make_html5:function(){var i=this,t=(i.settings.autoplay?"autoplay ":"")+(i.settings.loop?'loop onended="this.play()" ':""),o='<video width="100%" height="100%" '+t+">";i.settings.mp4!==!1&&(o+='<source src="'+i.settings.mp4+'" type="video/mp4"></source>'),i.settings.webm!==!1&&(o+='<source src="'+i.settings.webm+'" type="video/webm"></source>'),i.settings.ogg!==!1&&(o+='<source src="'+i.settings.ogg+'" type="video/ogg"></source>'),o+="</video>",i.video=e(o).css({position:"absolute"}),i.video_wrapper.append(i.video),i.player=i.video.get(0),i.settings.muted&&i.mute(),i.bind_video_resize()},make_youtube:function(){var i=this;i.video=e('<div id="'+i.id+'-video" class="video-bg-video"></div>').appendTo(i.video_wrapper).css({position:"absolute"}).hide(),i.youtube_ready=!1,s.get_youtube_api(i)},build_youtube:function(){var i=this,t={loop:0,start:i.settings.start,autoplay:i.settings.autoplay?1:0,controls:0,disablekb:1,showinfo:0,wmode:"transparent",iv_load_policy:3,modestbranding:1,rel:0,fs:0};i.settings.loop,i.youtube_started=0,i.player=new YT.Player(this.id+"-video",{height:"100%",width:"100%",playerVars:t,videoId:i.settings.youtube,events:{onReady:e.proxy(i.ready_youtube,i),onStateChange:function(e){1===e.data&&0===i.youtube_started&&(i.youtube_started=1,i.video.fadeIn()),0===e.data&&i.settings.loop&&(i.rewind(),i.play())}}})},ready_youtube:function(){var i=this;i.youtube_ready=!0,i.video=e("#"+i.id+"-video"),i.settings.mute&&i.mute(),i.bind_video_resize()},bind_video_resize:function(){var e=this;e.settings.video_ratio!==!1&&(e.window.on("resize.video-bg",{},o(function(i){e.video_resize()},100)),e.document.on("drupalViewportOffsetChange.toolbar",function(i,t){e.video_resize()}),e.video_resize())},video_resize:function(){var e=this,i=e.video_wrapper.width(),t=e.video_wrapper.height(),o=i,s=i/e.settings.video_ratio;s<t&&(s=t,o=t*e.settings.video_ratio),s=Math.ceil(s),o=Math.ceil(o);var n=Math.round(t/2-s/2),r=Math.round(i/2-o/2),u={width:o+"px",height:s+"px",top:n+"px",left:r+"px"};e.video.css(u),e.log("Video resized "+JSON.stringify(u)+".")},make_image:function(){},make_image_background:function(){var e=this;if(e.settings.image!==!1){var i={backgroundImage:"url("+e.settings.image+")",backgroundSize:"cover"};e.video_wrapper.css(i)}},isPlaying:function(){var e=this;return"html5"===e.decision?!e.video.paused:!("youtube"!==e.decision||!e.youtube_ready)&&1===e.player.getPlayerState()},play:function(){var e=this;"html5"===e.decision?e.player.play():"youtube"===e.decision&&e.youtube_ready&&e.player.playVideo(),this.log("Video play.")},pause:function(){var e=this;"html5"===e.decision?e.player.pause():"youtube"===e.decision&&e.youtube_ready&&e.player.pauseVideo(),this.log("Video pause.")},toggle_play:function(){var e=this;e.isPlaying()?this.pause():e.play()},is_mute:function(){var e=this;return"html5"===e.decision?!e.player.volume:!("youtube"!==e.decision||!e.youtube_ready)&&e.player.is_mute()},mute:function(){var e=this;"html5"===e.decision?e.player.volume=0:"youtube"===e.decision&&e.youtube_ready&&e.player.mute(),this.log("Video volume mute.")},unmute:function(){var e=this;"html5"===e.decision?e.player.volume=1:"youtube"===e.decision&&e.youtube_ready&&e.player.unMute(),this.log("Video volume unmute.")},toggleMute:function(){var e=this;e.is_mute()?e.unmute():e.mute()},rewind:function(){var e=this;"html5"===e.decision?e.player.currentTime=0:"youtube"===e.decision&&e.youtube_ready&&e.player.seekTo(0)},set_decision:function(){var e=this;e.decision="image",e.ismobile||!e.supportsVideo&&e.settings.youtube===!1||(this.decision=e.settings.priority,e.settings.youtube!==!1?e.decision="youtube":"html5"===e.settings.priority&&e.supportsVideo?e.decision="html5":this.supportsVideo&&(e.decision="html5")),e.log("Display decision is "+e.decision+".")},set_mobile_support:function(){this.ismobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},set_video_support:function(){var e=this;e.supportsVideo=t.video&&(t.video.h264&&e.settings.mp4!==!1||t.video.ogg&&e.settings.ogg!==!1||t.video.webm&&e.settings.webm!==!1),e.log("HTML5 video "+(e.supportsVideo?"is":"is not")+" supported or has not been requsted.")},set_inner_wrapper:function(){var i=this;i.video_wrapper=e('<div class="video-bg-inner"></div>').appendTo(i.wrapper).css({zIndex:this.settings.zIndex,position:this.settings.position,top:0,left:0,right:0,bottom:0,overflow:"hidden"}),i.make_image_background()},set_wrapper_id:function(){var e=this;null!=e.wrapper.attr("id")?e.id=e.wrapper.attr("id"):(e.id=e.get_random_id("video-bg"),e.wrapper.attr("id",e.id)),e.log("Element id has been set to "+e.id+".")},get_random_id:function(e){return e+"-"+Math.floor(1e5*Math.random()+1)},log:function(e){var i=this;s.log(e,"["+i.id+"]")},error:function(e){var i=this;s.error(e,"["+i.id+"]")}}),i.behaviors.videoBg={attach:function(i,t){if(t.videoBg&&t.videoBg.items)for(var o in t.videoBg.items)if(t.videoBg.items[o]){var n=e("#"+o,i).once("video-bg");n.length&&s.instances.push(new s(n,t.videoBg.items[o]))}}},i.VideoBg=s}(jQuery,Drupal,Modernizr,Drupal.debounce);